---
title: "Final Project"
author: Lauryn Pavlik
output: html_notebook
---
#Make sure to explain data sets and variables




##Clean environment and load packages
```{r message=TRUE}
#Clean up workspace environment
rm(list = ls())

#All packages used for the project
library(tidyr)
library(dplyr)
library(ggplot2)
library(rpart.plot)
library(rpart)

```

##Import first data set and name it 
```{r}
library(readr)
new_york <- read_csv("final decision.csv")
```

##View and make data table tidy 
```{r}
ny_data <- 
new_york %>%
 dplyr:: filter(Grade!="All Grades") %>%
  rename(district= "District", grade= "Grade", year= "Year", avg = "Mean Scale Score", level_1 = "Level 1 #", level_1_perc = "Level 1 %", level_2 = "Level 2 #", level_2_perc = "Level 2 %",level_3 = "Level 3 #", level_3_perc = "Level 3 %",level_4 = "Level 4 #", level_4_perc = "Level 4 %", students="Number Tested", sex= "Category" )
  
ny_data$`Level 3+4 #` <- NULL
ny_data$`Level 3+4 %` <- NULL

head(ny_data)



```

##Play around with data and find any correlation
###Does the number of students taking the benchmark increase the average score? 
```{r}
ny_data %>%
  ggplot(aes(x= students, y= avg)) + 
  geom_point(aes(color=sex)) +
  xlab("Number of Students") +
  ylab("Average Points Scored") +
  ggtitle("Average Score Overall")



```

There is a slight postive correlation, but nothing too signficant.
###Let's add more variables and see if there is any correlation between more and new variables.  
```{r}
ny_data %>%
  ggplot(aes(x= district, y= avg)) + 
  geom_point() +
  facet_grid(sex~year) +
  xlab("District Number") +
  ylab("Average Points Scored") +
  ggtitle("Gender's Average Score Over The Years")




```
Judging from the past graph, it seems that females have a slightly higher benchmark score. It is also noticeable that the scores over the districts in the more recent years have less of a postive correlation.These observations bring about a question: 

## Using a hypothesis test, is there statistically significant evidence that females have higher scores than males? 

### First, one must 
```{r}
no_levels<- 
  ny_data[,1:6]

female <- 
  no_levels %>%
data.frame() %>%
  spread(key= sex, value=avg) 

female$district <- NULL
female$grade <- NULL
female$students <- NULL
female$Male <- NULL

f_score <- female %>%
  drop_na()
```
  

```{r}
male <- 
  no_levels %>%
data.frame() %>%
  spread(key= sex, value=avg) 

male$district <- NULL
male$grade <- NULL
male$students <- NULL
male$Female <- NULL

m_score <- male %>%
  drop_na()
```

```{r}

mu1 <- as.vector(f_score$Female)
mu2 <- as.vector(m_score$Male)


t.test(mu1, mu2)


```
### Conclusion: YAY


## Based on a regression model, what variables contribute the most to the mean
```{r}

avg_mod<-
  ny_data %>%
  lm(students~ level_1_perc + level_2_perc + level_3_perc + level_4_perc, data=.)  


avg_mod$coefficients

```



```{r}

mod3 <- 
 ny_data %>% 
  rpart(avg ~ level_1 + level_2 + level_3 + level_4, data = .)

rpart.plot(mod3, roundint = FALSE)


```




