---
title: "Final Project"
author: "Lauryn Pavlik"
output: html_notebook
---
# Explanation Of The Data Set
The data set that is being used in this analysis is taken from data.gov. This set evolved from math benchmark data in New York. It contains information such as average score, number of participants, how many students scored in each category, and the percent of students in each category. Level one is the lowest score range and level four is the highest. This data is collected from 32 districts and six grade levels over the course of six years. 



## Clean environment and load packages
```{r message = FALSE}
# Clean up workspace environment
rm(list = ls())

# All packages used for the project
library(tidyr)
library(dplyr)
library(ggplot2)
library(rpart.plot)
library(rpart)

```

## Import the data set and name it 
```{r message = FALSE}
library(readr)
New_york <- read_csv("final decision.csv")
```

## View and make data table tidy 
```{r warning = FALSE}
# Rename the variables to accommodate style conventions
Ny_data <- 
New_york %>%
 dplyr:: filter(Grade != "All Grades") %>%
  rename(district = "District", grade = "Grade", year = "Year", avg = "Mean Scale Score", level_1 = "Level 1 #", level_1_perc = "Level 1 %", level_2 = "Level 2 #", level_2_perc = "Level 2 %", level_3 = "Level 3 #", level_3_perc = "Level 3 %", level_4 = "Level 4 #", level_4_perc = "Level 4 %", students = "Number Tested", sex = "Category")

# Remove repeated columns and non numeric inputs for quantitative variables
Ny_data$`Level 3+4 #` <- NULL
Ny_data$`Level 3+4 %` <- NULL

Ny_data %>%
  remove(row = "All Grades")

head(Ny_data)



```

## Ask questions to become familiar with the data 

### Does the number of students taking the benchmark increase the average score? 
```{r}
# Scatterplot 
Ny_data %>%
  ggplot(aes(x = students, y = avg)) + 
  geom_point(aes(color = sex)) +
  xlab("Number of Students") +
  ylab("Average Points Scored") +
  ggtitle("Average Score Overall")



```

It can be observed that there is a slight postive correlation, but nothing signficant to the eye. 

### Let's add more variables to see if there is any correlation between new variables  
```{r}
# Scatterplot
Ny_data %>% 
  ggplot(aes(x = district, y = avg)) + 
  geom_point() +
  facet_grid(sex ~ year) +  # Seperate data by year and by sex
  xlab("District Number") +
  ylab("Average Points Scored") +
  ggtitle("Gender's Average Score Over The Years")

```


Judging from the graph, it seems that females have a slightly higher benchmark score. It is also noticeable that the scores over the districts in the more recent years have less of a postive correlation. These observations bring about a question: 

## Using a hypothesis test, is there statistically significant evidence that females have higher scores than males? 

### First, create a data table of only female scores
```{r}
# Create table that only contains the first six variables of the original tidy table
No_levels <- 
  Ny_data[, 1:6] 

  
# Create table with only female scores
F_score <- 
  No_levels %>%
data.frame() %>%
  spread(key = sex, value = avg) %>%   # Spread sex into seperate columns
  rename(female = "Female") %>% 
  drop_na(female)   # Remove any missing values for females 

# Drop the four unneeded variables 
F_score$district <- NULL
F_score$grade <- NULL
F_score$students <- NULL
F_score$Male <- NULL




```
  
### Second, create a data table of only male scores   
```{r}
# Create table with only male scores
M_score <- 
  No_levels %>%
data.frame() %>%
  spread(key = sex, value = avg) %>%  # Again, spread sex into seperate columns
  rename(male = "Male") %>%
  drop_na(male) # Remove missing values for males

# Drop the four unneeded variables 
M_score$district <- NULL
M_score$grade <- NULL
M_score$students <- NULL
M_score$Female <- NULL


```

### Third, assign vectors to mu 1 and mu 2 and run a two sample t test
```{r}

mu_1 <- as.vector(F_score$female)
mu_2 <- as.vector(M_score$male)


t.test(mu_1, mu_2)


```
From this hypothesis test, a p value of 0.0003039 is produced. Since the p value is very small, the null hypothesis can be rejected and there is significant evidence produced, that females tend to have a greater average score on math benchmarks than males do. From this data, we are 95% confident that the average female score is about 1.22 points to 4.12 points higher than the male average score. 


## Now that we know females score 
```{r}

Avg_mod <-
  Ny_data %>%
  lm(students ~ level_1 + level_2 + level_3 + level_4, data = .)  


summary(Avg_mod)

```



```{r}

Avg_tree <- 
Ny_data %>% 
  rpart(avg ~ level_1 + level_2 + level_3 + level_4, data = .)

rpart.plot(Avg_tree, roundint = FALSE)


```




