---
title: "Final Project"
author: "Lauryn Pavlik"
output: html_notebook
---
# Explanation Of The Data Set
The data set that is being used in this analysis is taken from data.gov. This set evolved from math benchmark data in New York. It contains information such as average score, number of participates, how many students scored in each category, and the percent of students in each category. Level one is the lowest score range and level four is the highest. This data is collected from 32 districts and 



##Clean environment and load packages
```{r message=TRUE}
#Clean up workspace environment
rm(list = ls())

#All packages used for the project
library(tidyr)
library(dplyr)
library(ggplot2)
library(rpart.plot)
library(rpart)

```

##Import first data set and name it 
```{r}
library(readr)
New_york <- read_csv("final decision.csv")
```

##View and make data table tidy 
```{r}
Ny_data <- 
New_york %>%
 dplyr:: filter(Grade!="All Grades") %>%
  rename(district= "District", grade= "Grade", year= "Year", avg = "Mean Scale Score", level_1 = "Level 1 #", level_1_perc = "Level 1 %", level_2 = "Level 2 #", level_2_perc = "Level 2 %",level_3 = "Level 3 #", level_3_perc = "Level 3 %",level_4 = "Level 4 #", level_4_perc = "Level 4 %", students="Number Tested", sex= "Category" )
  
Ny_data$`Level 3+4 #` <- NULL
Ny_data$`Level 3+4 %` <- NULL

Ny_data %>%
  remove(row= "All Grades")

head(Ny_data)



```

##Play around with data and find any correlation
###Does the number of students taking the benchmark increase the average score? 
```{r}
Ny_data %>%
  ggplot(aes(x= students, y= avg)) + 
  geom_point(aes(color=sex)) +
  xlab("Number of Students") +
  ylab("Average Points Scored") +
  ggtitle("Average Score Overall")



```

There is a slight postive correlation, but nothing too signficant.
###Let's add more variables and see if there is any correlation between more and new variables.  
```{r}
Ny_data %>%
  ggplot(aes(x= district, y= avg)) + 
  geom_point() +
  facet_grid(sex~year) +
  xlab("District Number") +
  ylab("Average Points Scored") +
  ggtitle("Gender's Average Score Over The Years")




```
Judging from the past graph, it seems that females have a slightly higher benchmark score. It is also noticeable that the scores over the districts in the more recent years have less of a postive correlation.These observations bring about a question: 

## Using a hypothesis test, is there statistically significant evidence that females have higher scores than males? 

### First, one must 
```{r}
No_levels<- 
  Ny_data[,1:6] 

  

Female <- 
  No_levels %>%
data.frame() %>%
  spread(key= sex, value=avg) %>%
  rename(female="Female")
  
Female$district <- NULL
Female$grade <- NULL
Female$students <- NULL
Female$Male <- NULL

F_score <- Female %>%
  drop_na() 


```
  

```{r}
Male <- 
  No_levels %>%
data.frame() %>%
  spread(key= sex, value=avg) %>%
  rename(male="Male")

Male$district <- NULL
Male$grade <- NULL
Male$students <- NULL
Male$Female <- NULL

M_score <- Male %>%
  drop_na()
```

```{r}

mu1 <- as.vector(F_score$female)
mu2 <- as.vector(M_score$male)


t.test(mu1, mu2)


```
### Conclusion: YAY


###Based on a regression model, what variables contribute the most to the mean
```{r}

Avg_mod<-
  Ny_data %>%
  lm(students~ level_1_perc + level_2_perc + level_3_perc + level_4_perc, data=.)  


Avg_mod$coefficients

```



```{r}

Avg_tree <- 
 Ny_data %>% 
  rpart(avg ~ level_1 + level_2 + level_3 + level_4, data = .)

rpart.plot(Avg_tree, roundint = FALSE)


```




